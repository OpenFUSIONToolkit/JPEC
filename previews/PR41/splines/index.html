<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Splines · JPEC.jl</title><meta name="title" content="Splines · JPEC.jl"/><meta property="og:title" content="Splines · JPEC.jl"/><meta property="twitter:title" content="Splines · JPEC.jl"/><meta name="description" content="Documentation for JPEC.jl."/><meta property="og:description" content="Documentation for JPEC.jl."/><meta property="twitter:description" content="Documentation for JPEC.jl."/><meta property="og:url" content="https://OpenFUSIONToolkit.github.io/JPEC/splines/"/><meta property="twitter:url" content="https://OpenFUSIONToolkit.github.io/JPEC/splines/"/><link rel="canonical" href="https://OpenFUSIONToolkit.github.io/JPEC/splines/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">JPEC.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../set_up/">Setup</a></li><li><span class="tocitem">API Reference</span><ul><li class="is-active"><a class="tocitem" href>Splines</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Functions"><span>Functions</span></a></li><li><a class="tocitem" href="#Example-Usage"><span>Example Usage</span></a></li></ul></li><li><a class="tocitem" href="../vacuum/">Vacuum</a></li><li><a class="tocitem" href="../equilibrium/">Equilibrium</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../examples/splines/">Spline Examples</a></li><li><a class="tocitem" href="../examples/vacuum/">Vacuum Examples</a></li><li><a class="tocitem" href="../examples/equilibrium/">Equilibrium Examples</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API Reference</a></li><li class="is-active"><a href>Splines</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Splines</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/OpenFUSIONToolkit/JPEC" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/develop/docs/src/splines.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Splines-Module"><a class="docs-heading-anchor" href="#Splines-Module">Splines Module</a><a id="Splines-Module-1"></a><a class="docs-heading-anchor-permalink" href="#Splines-Module" title="Permalink"></a></h1><p>The Splines module provides cubic, bicubic, and fourier spline interpolation functionality, used for smooth representation of MHD equilibria.</p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The module includes:</p><ul><li>Cubic spline interpolation for 1D data</li><li>Bicubic spline interpolation for 2D data</li><li>Fourier spline interpolation for decomposed data</li><li>Derivative evaluation capabilities</li><li>Support for both real and complex-valued data</li></ul><h2 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.BicubicSpline-Tuple{Vector{Float64}, Vector{Float64}, Array{Float64, 3}}" href="#JPEC.SplinesMod.BicubicSpline-Tuple{Vector{Float64}, Vector{Float64}, Array{Float64, 3}}"><code>JPEC.SplinesMod.BicubicSpline</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>BicubicSpline(xs, ys, fs; 	bctypex::Union{String, Int}=&quot;not-a-knot&quot;, bctypey::Union{String, Int}=&quot;not-a-knot&quot;)</p><pre><code class="nohighlight hljs">## Arguments:
- `xs`: A vector of Float64 values representing the x-coordinates.
- `ys`: A vector of Float64 values representing the y-coordinates.
- `fs`: A 3D array of Float64 values representing the function values at the (x,y) coordinates.
## Keyword Arguments:
- `bctypex`: An integer specifying the boundary condition type for x (Default is 4, not a knot)
- `bctypey`: An integer specifying the boundary condition type for y  (Default is 4, not a knot)
## Returns:
- A `BicubicSpline` object containing the spline handle, x-coordinates, y-coordinates,
function values, number of x-coordinates, number of y-coordinates, number of quantities,
and boundary condition types.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/BicubicSpline.jl#L61-L76">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.CubicSpline-Union{Tuple{T}, Tuple{Vector{Float64}, VecOrMat{T}}} where T&lt;:Union{Float64, ComplexF64}" href="#JPEC.SplinesMod.CubicSpline-Union{Tuple{T}, Tuple{Vector{Float64}, VecOrMat{T}}} where T&lt;:Union{Float64, ComplexF64}"><code>JPEC.SplinesMod.CubicSpline</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CubicSpline(xs, fs; bctype=&quot;not-a-knot&quot;)

Arguments:
  - `xs`: A vector of Float64 values representing the x-coordinates.
  - `fs`: A vector or matrix of Float64/ComplexF64 values representing the function values at the x-coordinates.
Keyword Arguments:
  - `bctype`: Boundary condition type for the cubic spline in `x`.
    - 1: Natural spline (default)
    - 2: Periodic spline
    - 3: Extrapolated spline
    - 4: &quot;Not-a-knot&quot; spline

Returns:
  - A `CubicSpline` object containing the spline handle, x-coordinates, function values,
    number of x-coordinates, number of quantities, and index of x position in the spline.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/CubicSpline.jl#L73-L89">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.FourierSpline-Tuple{Vector{Float64}, Vector{Float64}, Array{Float64, 3}, Int64}" href="#JPEC.SplinesMod.FourierSpline-Tuple{Vector{Float64}, Vector{Float64}, Array{Float64, 3}, Int64}"><code>JPEC.SplinesMod.FourierSpline</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>FourierSpline(xs::Vector{Float64}, ys::Vector{Float64}, fs::Array{Float64, 3},     mband::Int; bctype::Union{String, Int}=&quot;not-a-knot&quot;, fit<em>method::Int=1, fit</em>flag::Bool=true)</p><pre><code class="nohighlight hljs">Creates and fits a function of two variables, f(x, y), to a cubic spline
in the x-direction and a Fourier series in the y-direction. The y-direction
is assumed to be periodic.

## Arguments:
- `xs`: Vector of x-coordinates (length `mx`+1).
- `ys`: Vector of y-coordinates (length `my`+1, periodic direction).
- `fs`: 3D array of function values with dimensions (`mx`+1, `my`+1, `nqty`).
- `mband`: Number of Fourier modes (harmonics) to keep, from 0 to `mband`.

## Keyword Arguments:
- `bctype`: Boundary condition type for the cubic spline in `x`.
    - 1: Natural spline (default)
    - 2: Periodic spline
    - 3: Extrapolated spline
    - 4: &quot;Not-a-knot&quot; spline
- `fit_method`: Algorithm for computing Fourier coefficients.
    - 1: Integration method (for non-uniform `y` grids).
    - 2: Fast Fourier Transform (FFT) method (requires `length(ys)-1` to be a power of 2).

## Returns:
- A `FourierSpline` object ready for evaluation.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/FourierSpline.jl#L91-L117">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.ReadOnlyArray" href="#JPEC.SplinesMod.ReadOnlyArray"><code>JPEC.SplinesMod.ReadOnlyArray</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">ReadOnlyArray{T,N,A}</code></pre><p>A thin wrapper that provides a read-only view.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/Helper.jl#L46-L50">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.bicube_eval" href="#JPEC.SplinesMod.bicube_eval"><code>JPEC.SplinesMod.bicube_eval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>bicube_eval(bicube::BicubicSpline, x, y, derivs::Int=0) 	## Arguments: 	- <code>bicube</code>: A <code>BicubicSpline</code> object. 	- <code>x</code>: A Float64 value or a vector of Float64 values representing the x-coordinates to evaluate the bicubic spline at. 	- <code>y</code>: A Float64 value or a vector of Float64 values representing the y-coordinates to evaluate the bicubic spline at. 	## Returns: 	- If <code>x</code> and <code>y</code> are single Float64 values, returns a vector of Float64 values representing the function values at that (x,y) coordinate. 	- If <code>x</code> and <code>y</code> are vectors of Float64 values, returns a 3D array of Float64 values where each slice corresponds to the function values at 	the respective (x,y) coordinates in <code>x</code> and <code>y</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/BicubicSpline.jl#L106-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.fspline_eval" href="#JPEC.SplinesMod.fspline_eval"><code>JPEC.SplinesMod.fspline_eval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>fspline_eval(fspline::FourierSpline, xs::Vector{Float64}, ys::Vector{Float64}, derivs::Int=0)</p><pre><code class="nohighlight hljs">Evaluates a fitted Fourier-Spline at given coordinates.

## Arguments:
- `fspline`: A `FourierSpline` object.
- `x`: A `Vector{Float64}` of x-coordinates.
- `y`: A `Vector{Float64}` of y-coordinates.

## Returns:
- If `x`, `y` are vectors: A tuple of 3D arrays for the function values and derivatives on the grid defined by `x` and `y`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/FourierSpline.jl#L211-L223">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.fspline_eval" href="#JPEC.SplinesMod.fspline_eval"><code>JPEC.SplinesMod.fspline_eval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>fspline_eval(fspline::FourierSpline, x::Float64, y::Float64, derivs::Int=0)</p><pre><code class="nohighlight hljs">Evaluates a fitted Fourier-Spline at given coordinates.

## Arguments:
- `fspline`: A `FourierSpline` object.
- `x`: A `Float64` x-coordinate.
- `y`: A `Float64` y-coordinate.

## Returns:
- If `x`, `y` are scalars: A tuple containing the function value(s) and any requested derivatives. If nqty=1, the results are scalars, otherwise they are vectors.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/FourierSpline.jl#L164-L176">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.parse_bctype-Tuple{String}" href="#JPEC.SplinesMod.parse_bctype-Tuple{String}"><code>JPEC.SplinesMod.parse_bctype</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parse_bctype(bctype)</code></pre><p>Internal helper to parse a boundary condition into a validated integer code.</p><p><strong>Arguments:</strong></p><ul><li><code>bctype</code>: The boundary condition as a <code>String</code> or <code>Int</code>. Valid options are:<ul><li><code>&quot;natural&quot;</code> or <code>1</code></li><li><code>&quot;periodic&quot;</code> or <code>2</code></li><li><code>&quot;extrap&quot;</code> or <code>3</code></li><li><code>&quot;not-a-knot&quot;</code> or <code>4</code></li></ul></li></ul><p><strong>Returns:</strong></p><ul><li>A validated <code>Int</code> code (1-4).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/Helper.jl#L9-L23">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.spline_eval!-Union{Tuple{T}, Tuple{Vector{T}, JPEC.SplinesMod.CubicSpline{T}, Float64}} where T&lt;:Union{Float64, ComplexF64}" href="#JPEC.SplinesMod.spline_eval!-Union{Tuple{T}, Tuple{Vector{T}, JPEC.SplinesMod.CubicSpline{T}, Float64}} where T&lt;:Union{Float64, ComplexF64}"><code>JPEC.SplinesMod.spline_eval!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spline_eval!(f, spline, x; derivs=0, f1=nothing, f2=nothing, f3=nothing)</code></pre><p>In-place evaluation of <code>CubicSpline</code> at a single point <code>x</code>.</p><p>Arguments:</p><ul><li><code>f</code>: preallocated vector for the function values (length = spline.nqty).</li><li><code>spline</code>: the cubic spline object.</li><li><code>x</code>: Float64 input point.</li><li><code>derivs</code>: number of derivatives to evaluate (0–3).</li><li><code>f1</code>, <code>f2</code>, <code>f3</code>: optional preallocated vectors for first, second, third derivatives.</li></ul><p>Results are written into <code>f</code> (and optionally <code>f1</code>, <code>f2</code>, <code>f3</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/CubicSpline.jl#L191-L204">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.spline_eval-Union{Tuple{T}, Tuple{JPEC.SplinesMod.CubicSpline{T}, Float64}, Tuple{JPEC.SplinesMod.CubicSpline{T}, Float64, Int64}} where T&lt;:Union{Float64, ComplexF64}" href="#JPEC.SplinesMod.spline_eval-Union{Tuple{T}, Tuple{JPEC.SplinesMod.CubicSpline{T}, Float64}, Tuple{JPEC.SplinesMod.CubicSpline{T}, Float64, Int64}} where T&lt;:Union{Float64, ComplexF64}"><code>JPEC.SplinesMod.spline_eval</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>spline_eval(spline::CubicSpline{T}, x, derivs::Int=0) where {T&lt;:Union{Float64, ComplexF64}} 	## Arguments: 	- <code>spline</code>: A <code>Spline</code> object created by <code>CubicSpline</code>. 	- <code>x</code>: A Float64 value or a vector of Float64 values representing the x-coordinates to evaluate the spline at. 	## Returns: 	- If <code>x</code> is a single Float64 value, returns a vector of Float64 values representing the function values at that x-coordinate. 	- If <code>x</code> is a vector of Float64 values, returns a matrix of Float64 values where each row corresponds to the function values at 	  the respective x-coordinate in <code>x</code>. 	- Depending on the derivatives requested, it may return additional vectors for the first, second, or third derivatives.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/CubicSpline.jl#L106-L116">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.spline_integrate!-Union{Tuple{JPEC.SplinesMod.CubicSpline{T}}, Tuple{T}} where T&lt;:Union{Float64, ComplexF64}" href="#JPEC.SplinesMod.spline_integrate!-Union{Tuple{JPEC.SplinesMod.CubicSpline{T}}, Tuple{T}} where T&lt;:Union{Float64, ComplexF64}"><code>JPEC.SplinesMod.spline_integrate!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">spline_integrate!(spline::CubicSpline{T}) where {T&lt;:Union{Float64, ComplexF64}}

## Arguments:
- `spline`: A mutable `Spline` object&quot;.

## Returns:
- Nothing. Updates `spline._fsi` in place so that
`spline._fsi[i, :]` equals `∫_{xs[1]}^{xs[i]} f(x) dx` for each component.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/CubicSpline.jl#L224-L233">source</a></section></article><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><h3 id="CubicSplineType"><a class="docs-heading-anchor" href="#CubicSplineType">CubicSplineType</a><a id="CubicSplineType-1"></a><a class="docs-heading-anchor-permalink" href="#CubicSplineType" title="Permalink"></a></h3><p>Represents a cubic spline interpolation object.</p><h3 id="BicubicSplineType"><a class="docs-heading-anchor" href="#BicubicSplineType">BicubicSplineType</a><a id="BicubicSplineType-1"></a><a class="docs-heading-anchor-permalink" href="#BicubicSplineType" title="Permalink"></a></h3><p>Represents a bicubic spline interpolation object for 2D data.</p><h3 id="FourierSplineType"><a class="docs-heading-anchor" href="#FourierSplineType">FourierSplineType</a><a id="FourierSplineType-1"></a><a class="docs-heading-anchor-permalink" href="#FourierSplineType" title="Permalink"></a></h3><p>Represents a Fourier spline interpolation object for decomposed data.</p><h2 id="Functions"><a class="docs-heading-anchor" href="#Functions">Functions</a><a id="Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Functions" title="Permalink"></a></h2><h3 id="CubicSpline"><a class="docs-heading-anchor" href="#CubicSpline">CubicSpline</a><a id="CubicSpline-1"></a><a class="docs-heading-anchor-permalink" href="#CubicSpline" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.CubicSpline" href="#JPEC.SplinesMod.CubicSpline"><code>JPEC.SplinesMod.CubicSpline</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CubicSpline(xs, fs; bctype=&quot;not-a-knot&quot;)

Arguments:
  - `xs`: A vector of Float64 values representing the x-coordinates.
  - `fs`: A vector or matrix of Float64/ComplexF64 values representing the function values at the x-coordinates.
Keyword Arguments:
  - `bctype`: Boundary condition type for the cubic spline in `x`.
    - 1: Natural spline (default)
    - 2: Periodic spline
    - 3: Extrapolated spline
    - 4: &quot;Not-a-knot&quot; spline

Returns:
  - A `CubicSpline` object containing the spline handle, x-coordinates, function values,
    number of x-coordinates, number of quantities, and index of x position in the spline.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/CubicSpline.jl#L73-L89">source</a></section></article><h3 id="spline_eval"><a class="docs-heading-anchor" href="#spline_eval">spline_eval</a><a id="spline_eval-1"></a><a class="docs-heading-anchor-permalink" href="#spline_eval" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.spline_eval" href="#JPEC.SplinesMod.spline_eval"><code>JPEC.SplinesMod.spline_eval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>spline_eval(spline::CubicSpline{T}, x, derivs::Int=0) where {T&lt;:Union{Float64, ComplexF64}} 	## Arguments: 	- <code>spline</code>: A <code>Spline</code> object created by <code>CubicSpline</code>. 	- <code>x</code>: A Float64 value or a vector of Float64 values representing the x-coordinates to evaluate the spline at. 	## Returns: 	- If <code>x</code> is a single Float64 value, returns a vector of Float64 values representing the function values at that x-coordinate. 	- If <code>x</code> is a vector of Float64 values, returns a matrix of Float64 values where each row corresponds to the function values at 	  the respective x-coordinate in <code>x</code>. 	- Depending on the derivatives requested, it may return additional vectors for the first, second, or third derivatives.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/CubicSpline.jl#L106-L116">source</a></section></article><h3 id="BicubicSpline"><a class="docs-heading-anchor" href="#BicubicSpline">BicubicSpline</a><a id="BicubicSpline-1"></a><a class="docs-heading-anchor-permalink" href="#BicubicSpline" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.BicubicSpline" href="#JPEC.SplinesMod.BicubicSpline"><code>JPEC.SplinesMod.BicubicSpline</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>BicubicSpline(xs, ys, fs; 	bctypex::Union{String, Int}=&quot;not-a-knot&quot;, bctypey::Union{String, Int}=&quot;not-a-knot&quot;)</p><pre><code class="nohighlight hljs">## Arguments:
- `xs`: A vector of Float64 values representing the x-coordinates.
- `ys`: A vector of Float64 values representing the y-coordinates.
- `fs`: A 3D array of Float64 values representing the function values at the (x,y) coordinates.
## Keyword Arguments:
- `bctypex`: An integer specifying the boundary condition type for x (Default is 4, not a knot)
- `bctypey`: An integer specifying the boundary condition type for y  (Default is 4, not a knot)
## Returns:
- A `BicubicSpline` object containing the spline handle, x-coordinates, y-coordinates,
function values, number of x-coordinates, number of y-coordinates, number of quantities,
and boundary condition types.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/BicubicSpline.jl#L61-L76">source</a></section></article><h3 id="bicube_eval"><a class="docs-heading-anchor" href="#bicube_eval">bicube_eval</a><a id="bicube_eval-1"></a><a class="docs-heading-anchor-permalink" href="#bicube_eval" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.bicube_eval" href="#JPEC.SplinesMod.bicube_eval"><code>JPEC.SplinesMod.bicube_eval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>bicube_eval(bicube::BicubicSpline, x, y, derivs::Int=0) 	## Arguments: 	- <code>bicube</code>: A <code>BicubicSpline</code> object. 	- <code>x</code>: A Float64 value or a vector of Float64 values representing the x-coordinates to evaluate the bicubic spline at. 	- <code>y</code>: A Float64 value or a vector of Float64 values representing the y-coordinates to evaluate the bicubic spline at. 	## Returns: 	- If <code>x</code> and <code>y</code> are single Float64 values, returns a vector of Float64 values representing the function values at that (x,y) coordinate. 	- If <code>x</code> and <code>y</code> are vectors of Float64 values, returns a 3D array of Float64 values where each slice corresponds to the function values at 	the respective (x,y) coordinates in <code>x</code> and <code>y</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/BicubicSpline.jl#L106-L116">source</a></section></article><h3 id="FourierSpline"><a class="docs-heading-anchor" href="#FourierSpline">FourierSpline</a><a id="FourierSpline-1"></a><a class="docs-heading-anchor-permalink" href="#FourierSpline" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.FourierSpline" href="#JPEC.SplinesMod.FourierSpline"><code>JPEC.SplinesMod.FourierSpline</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>FourierSpline(xs::Vector{Float64}, ys::Vector{Float64}, fs::Array{Float64, 3},     mband::Int; bctype::Union{String, Int}=&quot;not-a-knot&quot;, fit<em>method::Int=1, fit</em>flag::Bool=true)</p><pre><code class="nohighlight hljs">Creates and fits a function of two variables, f(x, y), to a cubic spline
in the x-direction and a Fourier series in the y-direction. The y-direction
is assumed to be periodic.

## Arguments:
- `xs`: Vector of x-coordinates (length `mx`+1).
- `ys`: Vector of y-coordinates (length `my`+1, periodic direction).
- `fs`: 3D array of function values with dimensions (`mx`+1, `my`+1, `nqty`).
- `mband`: Number of Fourier modes (harmonics) to keep, from 0 to `mband`.

## Keyword Arguments:
- `bctype`: Boundary condition type for the cubic spline in `x`.
    - 1: Natural spline (default)
    - 2: Periodic spline
    - 3: Extrapolated spline
    - 4: &quot;Not-a-knot&quot; spline
- `fit_method`: Algorithm for computing Fourier coefficients.
    - 1: Integration method (for non-uniform `y` grids).
    - 2: Fast Fourier Transform (FFT) method (requires `length(ys)-1` to be a power of 2).

## Returns:
- A `FourierSpline` object ready for evaluation.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/FourierSpline.jl#L91-L117">source</a></section></article><h3 id="fspline_eval"><a class="docs-heading-anchor" href="#fspline_eval">fspline_eval</a><a id="fspline_eval-1"></a><a class="docs-heading-anchor-permalink" href="#fspline_eval" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="JPEC.SplinesMod.fspline_eval" href="#JPEC.SplinesMod.fspline_eval"><code>JPEC.SplinesMod.fspline_eval</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><p>fspline_eval(fspline::FourierSpline, x::Float64, y::Float64, derivs::Int=0)</p><pre><code class="nohighlight hljs">Evaluates a fitted Fourier-Spline at given coordinates.

## Arguments:
- `fspline`: A `FourierSpline` object.
- `x`: A `Float64` x-coordinate.
- `y`: A `Float64` y-coordinate.

## Returns:
- If `x`, `y` are scalars: A tuple containing the function value(s) and any requested derivatives. If nqty=1, the results are scalars, otherwise they are vectors.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/FourierSpline.jl#L164-L176">source</a></section><section><div><p>fspline_eval(fspline::FourierSpline, xs::Vector{Float64}, ys::Vector{Float64}, derivs::Int=0)</p><pre><code class="nohighlight hljs">Evaluates a fitted Fourier-Spline at given coordinates.

## Arguments:
- `fspline`: A `FourierSpline` object.
- `x`: A `Vector{Float64}` of x-coordinates.
- `y`: A `Vector{Float64}` of y-coordinates.

## Returns:
- If `x`, `y` are vectors: A tuple of 3D arrays for the function values and derivatives on the grid defined by `x` and `y`.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/OpenFUSIONToolkit/JPEC/blob/eca04503688d6d861ee55a206826109feb8a0d97/src/Splines/FourierSpline.jl#L211-L223">source</a></section></article><h2 id="Example-Usage"><a class="docs-heading-anchor" href="#Example-Usage">Example Usage</a><a id="Example-Usage-1"></a><a class="docs-heading-anchor-permalink" href="#Example-Usage" title="Permalink"></a></h2><h3 id="1D-Cubic-Spline"><a class="docs-heading-anchor" href="#1D-Cubic-Spline">1D Cubic Spline</a><a id="1D-Cubic-Spline-1"></a><a class="docs-heading-anchor-permalink" href="#1D-Cubic-Spline" title="Permalink"></a></h3><pre><code class="language-julia hljs">using JPEC

# Create data points
xs = collect(range(0.0, stop=2π, length=21))
fs = sin.(xs)

# Set up spline (1 quantity)
spline = JPEC.SplinesMod.CubicSpline(xs, hcat(fs), 1)

# Evaluate at new points
xs_fine = collect(range(0.0, stop=2π, length=100))
fs_fine = JPEC.SplinesMod.spline_eval(spline, xs_fine)</code></pre><h3 id="2D-Bicubic-Spline"><a class="docs-heading-anchor" href="#2D-Bicubic-Spline">2D Bicubic Spline</a><a id="2D-Bicubic-Spline-1"></a><a class="docs-heading-anchor-permalink" href="#2D-Bicubic-Spline" title="Permalink"></a></h3><pre><code class="language-julia hljs"># Create 2D grid
xs = collect(range(0.0, stop=2π, length=20))
ys = collect(range(0.0, stop=2π, length=20))

# Create 2D function data
fs = zeros(20, 20, 1)
for i in 1:20, j in 1:20
    fs[i, j, 1] = sin(xs[i]) * cos(ys[j])
end

# Set up bicubic spline
bcspline = JPEC.SplinesMod.BicubicSpline(xs, ys, fs, 1, 1)

# Evaluate with derivatives
x_eval, y_eval = π/2, π/4
f, fx, fy = JPEC.SplinesMod.bicube_eval(bcspline, x_eval, y_eval, 1)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../set_up/">« Setup</a><a class="docs-footer-nextpage" href="../vacuum/">Vacuum »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Thursday 9 October 2025 21:53">Thursday 9 October 2025</span>. Using Julia version 1.11.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
